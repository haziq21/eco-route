import{S as r,i as s,s as t,e as a,t as n,k as e,c as o,a as l,g as c,d as i,n as u,b as f,f as h,E as p,h as m,O as v,r as d,u as $,w as g,x as b,Z as S,j as k,l as A,m as E,o as N,v as w,L as x,A as y,_ as P,Q as j,R as _,P as z,a1 as B,a2 as D}from"../chunks/vendor-ba6e0429.js";import{B as C}from"../chunks/Box-53f6f880.js";import{S as H}from"../chunks/Searchbar-0e7def4f.js";import{o as L,d as W,c as T}from"../chunks/_stores-027b8861.js";import"../chunks/navigation-51f4a605.js";import"../chunks/singletons-12a22614.js";import"../chunks/stores-1c755569.js";function I(r){let s,t,d,$,g,b,S,k,A,E,N,w,x,y=r[0].minutesToArrival+"",P={SEA:"person",SDA:"group",LSD:"groups"}[r[0].occupancy]+"";return{c(){s=a("span"),t=a("span"),d=n(y),$=e(),g=a("span"),b=n("min"),S=e(),k=a("span"),A=a("span"),E=n(P),N=e(),w=a("span"),x=n("directions_bus"),this.h()},l(r){s=o(r,"SPAN",{class:!0});var a=l(s);t=o(a,"SPAN",{class:!0});var n=l(t);d=c(n,y),n.forEach(i),$=u(a),g=o(a,"SPAN",{class:!0});var e=l(g);b=c(e,"min"),e.forEach(i),S=u(a),k=o(a,"SPAN",{class:!0});var f=l(k);A=o(f,"SPAN",{class:!0});var h=l(A);E=c(h,P),h.forEach(i),N=u(f),w=o(f,"SPAN",{class:!0});var p=l(w);x=c(p,"directions_bus"),p.forEach(i),f.forEach(i),a.forEach(i),this.h()},h(){f(t,"class","number svelte-1o986wm"),f(g,"class","time-unit svelte-1o986wm"),f(A,"class","material-icons"),f(w,"class","material-icons"),f(k,"class","icons svelte-1o986wm"),f(s,"class","info svelte-1o986wm")},m(r,a){h(r,s,a),p(s,t),p(t,d),p(s,$),p(s,g),p(g,b),p(s,S),p(s,k),p(k,A),p(A,E),p(k,N),p(k,w),p(w,x)},p(r,[s]){1&s&&y!==(y=r[0].minutesToArrival+"")&&m(d,y),1&s&&P!==(P={SEA:"person",SDA:"group",LSD:"groups"}[r[0].occupancy]+"")&&m(E,P)},i:v,o:v,d(r){r&&i(s)}}}function O(r,s,t){let{arrival:a}=s;return r.$$set=r=>{"arrival"in r&&t(0,a=r.arrival)},[a]}class Q extends r{constructor(r){super(),s(this,r,O,I,t,{arrival:0})}}function R(r,s,t){const a=r.slice();return a[1]=s[t],a}function V(r){let s,t;return{c(){s=a("span"),t=n("No arrivals available"),this.h()},l(r){s=o(r,"SPAN",{class:!0});var a=l(s);t=c(a,"No arrivals available"),a.forEach(i),this.h()},h(){f(s,"class","error-message svelte-19zboyn")},m(r,a){h(r,s,a),p(s,t)},p:v,i:v,o:v,d(r){r&&i(s)}}}function Z(r){let s,t,m,v,S,x,y,P,j;s=new Q({props:{arrival:r[1].arrivals[0]}});const _=[F,q],z=[];function B(r,s){return r[1].arrivals[1]?0:1}return x=B(r),y=z[x]=_[x](r),{c(){k(s.$$.fragment),t=e(),m=a("span"),v=n("➤"),S=e(),y.c(),P=A(),this.h()},l(r){E(s.$$.fragment,r),t=u(r),m=o(r,"SPAN",{class:!0});var a=l(m);v=c(a,"➤"),a.forEach(i),S=u(r),y.l(r),P=A(),this.h()},h(){f(m,"class","separator svelte-19zboyn")},m(r,a){N(s,r,a),h(r,t,a),h(r,m,a),p(m,v),h(r,S,a),z[x].m(r,a),h(r,P,a),j=!0},p(r,t){const a={};1&t&&(a.arrival=r[1].arrivals[0]),s.$set(a);let n=x;x=B(r),x===n?z[x].p(r,t):(d(),$(z[n],1,1,(()=>{z[n]=null})),g(),y=z[x],y?y.p(r,t):(y=z[x]=_[x](r),y.c()),b(y,1),y.m(P.parentNode,P))},i(r){j||(b(s.$$.fragment,r),b(y),j=!0)},o(r){$(s.$$.fragment,r),$(y),j=!1},d(r){w(s,r),r&&i(t),r&&i(m),r&&i(S),z[x].d(r),r&&i(P)}}}function q(r){let s;return{c(){s=n("NA")},l(r){s=c(r,"NA")},m(r,t){h(r,s,t)},p:v,i:v,o:v,d(r){r&&i(s)}}}function F(r){let s,t;return s=new Q({props:{arrival:r[1].arrivals[1]}}),{c(){k(s.$$.fragment)},l(r){E(s.$$.fragment,r)},m(r,a){N(s,r,a),t=!0},p(r,t){const a={};1&t&&(a.arrival=r[1].arrivals[1]),s.$set(a)},i(r){t||(b(s.$$.fragment,r),t=!0)},o(r){$(s.$$.fragment,r),t=!1},d(r){w(s,r)}}}function G(r){let s,t,v,S,k,A,E,N,w,x=r[1].number+"";const y=[Z,V],P=[];function j(r,s){return r[1].arrivals[0]?0:1}return A=j(r),E=P[A]=y[A](r),{c(){s=a("h3"),t=n(x),v=e(),S=a("span"),k=e(),E.c(),N=e(),this.h()},l(r){s=o(r,"H3",{class:!0});var a=l(s);t=c(a,x),a.forEach(i),v=u(r),S=o(r,"SPAN",{class:!0}),l(S).forEach(i),k=u(r),E.l(r),N=u(r),this.h()},h(){f(s,"class","bus-number svelte-19zboyn"),f(S,"class","spacing svelte-19zboyn")},m(r,a){h(r,s,a),p(s,t),h(r,v,a),h(r,S,a),h(r,k,a),P[A].m(r,a),h(r,N,a),w=!0},p(r,s){(!w||1&s)&&x!==(x=r[1].number+"")&&m(t,x);let a=A;A=j(r),A===a?P[A].p(r,s):(d(),$(P[a],1,1,(()=>{P[a]=null})),g(),E=P[A],E?E.p(r,s):(E=P[A]=y[A](r),E.c()),b(E,1),E.m(N.parentNode,N))},i(r){w||(b(E),w=!0)},o(r){$(E),w=!1},d(r){r&&i(s),r&&i(v),r&&i(S),r&&i(k),P[A].d(r),r&&i(N)}}}function J(r){let s,t,v,k,A,E=r[0].busStopCode+"",N=r[0].services,w=[];for(let a=0;a<N.length;a+=1)w[a]=G(R(r,N,a));const x=r=>$(w[r],1,1,(()=>{w[r]=null}));return{c(){s=a("h3"),t=n(E),v=e(),k=a("div");for(let r=0;r<w.length;r+=1)w[r].c();this.h()},l(r){s=o(r,"H3",{});var a=l(s);t=c(a,E),a.forEach(i),v=u(r),k=o(r,"DIV",{class:!0});var n=l(k);for(let s=0;s<w.length;s+=1)w[s].l(n);n.forEach(i),this.h()},h(){f(k,"class","bus-stop svelte-19zboyn")},m(r,a){h(r,s,a),p(s,t),h(r,v,a),h(r,k,a);for(let s=0;s<w.length;s+=1)w[s].m(k,null);A=!0},p(r,[s]){if((!A||1&s)&&E!==(E=r[0].busStopCode+"")&&m(t,E),1&s){let t;for(N=r[0].services,t=0;t<N.length;t+=1){const a=R(r,N,t);w[t]?(w[t].p(a,s),b(w[t],1)):(w[t]=G(a),w[t].c(),b(w[t],1),w[t].m(k,null))}for(d(),t=N.length;t<w.length;t+=1)x(t);g()}},i(r){if(!A){for(let r=0;r<N.length;r+=1)b(w[r]);A=!0}},o(r){w=w.filter(Boolean);for(let s=0;s<w.length;s+=1)$(w[s]);A=!1},d(r){r&&i(s),r&&i(v),r&&i(k),S(w,r)}}}function K(r,s,t){let{arrivals:a}=s;return r.$$set=r=>{"arrivals"in r&&t(0,a=r.arrivals)},[a]}class M extends r{constructor(r){super(),s(this,r,K,J,t,{arrivals:0})}}function U(r){let s;return{c(){s=n("text")},l(r){s=c(r,"text")},m(r,t){h(r,s,t)},p:v,i:v,o:v,d(r){r&&i(s)}}}function X(r){let s,t,a={ctx:r,current:null,token:null,hasCatch:!0,pending:sr,then:rr,catch:Y,value:8,error:9,blocks:[,,,]};return B(r[1](),a),{c(){s=A(),a.block.c()},l(r){s=A(),a.block.l(r)},m(r,n){h(r,s,n),a.block.m(r,a.anchor=n),a.mount=()=>s.parentNode,a.anchor=s,t=!0},p(s,t){D(a,r=s,t)},i(r){t||(b(a.block),t=!0)},o(r){for(let s=0;s<3;s+=1){const r=a.blocks[s];$(r)}t=!1},d(r){r&&i(s),a.block.d(r),a.token=null,a=null}}}function Y(r){let s,t,e,u=r[9].message+"";return{c(){s=a("p"),t=n("error: "),e=n(u)},l(r){s=o(r,"P",{});var a=l(s);t=c(a,"error: "),e=c(a,u),a.forEach(i)},m(r,a){h(r,s,a),p(s,t),p(s,e)},p:v,i:v,o:v,d(r){r&&i(s)}}}function rr(r){let s,t;return s=new M({props:{arrivals:r[8].data}}),{c(){k(s.$$.fragment)},l(r){E(s.$$.fragment,r)},m(r,a){N(s,r,a),t=!0},p:v,i(r){t||(b(s.$$.fragment,r),t=!0)},o(r){$(s.$$.fragment,r),t=!1},d(r){w(s,r)}}}function sr(r){let s,t;return{c(){s=a("p"),t=n("loading...")},l(r){s=o(r,"P",{});var a=l(s);t=c(a,"loading..."),a.forEach(i)},m(r,a){h(r,s,a),p(s,t)},p:v,i:v,o:v,d(r){r&&i(s)}}}function tr(r){let s,t,f,m,v,S,x,y,P,B;function D(s){r[3](s)}let C={placeholder:"Search for a bus number or stop"};void 0!==r[0]&&(C.text=r[0]),m=new H({props:C}),j.push((()=>_(m,"text",D)));const L=[X,U],W=[];function T(r,s){return r[0]?1:0}return x=T(r),y=W[x]=L[x](r),{c(){s=a("h1"),t=n("Bus arrivals"),f=e(),k(m.$$.fragment),S=e(),y.c(),P=A()},l(r){s=o(r,"H1",{});var a=l(s);t=c(a,"Bus arrivals"),a.forEach(i),f=u(r),E(m.$$.fragment,r),S=u(r),y.l(r),P=A()},m(r,a){h(r,s,a),p(s,t),h(r,f,a),N(m,r,a),h(r,S,a),W[x].m(r,a),h(r,P,a),B=!0},p(r,s){const t={};!v&&1&s&&(v=!0,t.text=r[0],z((()=>v=!1))),m.$set(t);let a=x;x=T(r),x===a?W[x].p(r,s):(d(),$(W[a],1,1,(()=>{W[a]=null})),g(),y=W[x],y?y.p(r,s):(y=W[x]=L[x](r),y.c()),b(y,1),y.m(P.parentNode,P))},i(r){B||(b(m.$$.fragment,r),b(y),B=!0)},o(r){$(m.$$.fragment,r),$(y),B=!1},d(r){r&&i(s),r&&i(f),w(m,r),r&&i(S),W[x].d(r),r&&i(P)}}}function ar(r){let s,t;return s=new C({props:{$$slots:{default:[tr]},$$scope:{ctx:r}}}),{c(){k(s.$$.fragment)},l(r){E(s.$$.fragment,r)},m(r,a){N(s,r,a),t=!0},p(r,[t]){const a={};1025&t&&(a.$$scope={dirty:t,ctx:r}),s.$set(a)},i(r){t||(b(s.$$.fragment,r),t=!0)},o(r){$(s.$$.fragment,r),t=!1},d(r){w(s,r)}}}const nr=!1;function er(r,s,t){let a,n,e;x(r,T,(r=>t(2,a=r))),x(r,L,(r=>t(4,n=r))),x(r,W,(r=>t(5,e=r)));var o=this&&this.__awaiter||function(r,s,t,a){return new(t||(t=Promise))((function(n,e){function o(r){try{c(a.next(r))}catch(s){e(s)}}function l(r){try{c(a.throw(r))}catch(s){e(s)}}function c(r){var s;r.done?n(r.value):(s=r.value,s instanceof t?s:new t((function(r){r(s)}))).then(o,l)}c((a=a.apply(r,s||[])).next())}))};let l;return y((()=>o(void 0,void 0,void 0,(function*(){try{const r=yield navigator.serviceWorker.register("/sw.js");console.log("ServiceWorker registration successful with scope: ",r.scope)}catch(r){console.log("ServiceWorker registration failed: ",r)}})))),P(W,e={name:"",address:"",longitude:null,latitude:null},e),r.$$.update=()=>{4&r.$$.dirty&&P(L,n=a,n)},[l,function(){return o(this,void 0,void 0,(function*(){const r=yield fetch("/api/bus-arrivals");return yield r.json()}))},a,function(r){l=r,t(0,l)}]}class or extends r{constructor(r){super(),s(this,r,er,ar,t,{})}}export{or as default,nr as ssr};
